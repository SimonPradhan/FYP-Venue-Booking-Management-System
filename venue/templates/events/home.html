{% extends 'base.html' %}
{% load static %}
{% block content %}
<div class="container text-center">
    <div class="font-montserrat">
        <h1>Book Now</h1>
        <h2>Venue of Choice</h2>
    </div>
</div>

<div class="main">

</div>

<div class="container position-absolute" style="margin-top: 620px; margin-left: 100px;" >
    <div class="row justify-content-center">
        <div class="col-md-6">
            <form class="d-flex" role="search" method="get">
                <div class="input-group">
                    <input type="search" class="form-control" placeholder="Search Venues by Name..." aria-label="search"
                        name="venuename" value="{{ venuename }}">
                    <input type="search" class="form-control" placeholder="Search Venues by Location..." aria-label="search"
                        name="location" value="{{ location }}">
                    <div class="input-group-append">
                        <button class="btn btn-primary" type="submit">Search</button>
                    </div>
                </div>
            </form>
            
            
        </div>
    </div>
</div>
<img src="{% static 'images/venue.png' %}" class="img-fluid" style="width: 94.9rem;" alt="Responsive image">


<div class="container d-flex justify-content-center font-montserrat" style="margin-top: 40px; padding: 10px;">
    <h1> Top Venues</h1>
</div>
<div class="container sm-4">
    <div class="row">
        {% if search_data %}
        <h3>Search Results for "{{ search_data }}":</h3>
        {% for venue in list_venue %}
            {% if venue.venuename|lower == search_data|lower %}
                <div class="col-md-4 mb-3">
                    <div class="card" onclick="toggleDescription(this)" style="cursor:pointer;">
                        <img src="/media/{{ venue.image }}" class="card-img-top rounded-top" alt="{{ venue.name }} Image"
                            width="400" height="400">
                        <div class="card-body">
                            <h5 class="card-title">{{ venue.venuename }}</h5>
                            <ul class="list-unstyled">
                                <li><strong>Address:</strong> {{ venue.address }}</li>
                                <li><strong>Price:</strong> {{ venue.price }} (per plates)</li>
                                <li><strong>Capacity:</strong> {{ venue.capacity }} people</li>
                                <li><strong>Phone:</strong> {{ venue.phone }}</li>
                                <div class="description"
                                    style="max-height: 0; overflow: hidden; transition: max-height 0.3s ease-out;">
                                    <li><strong>Description:</strong>
                                        {{ venue.description }}
                                    </li>
                                    <br>
                                    <a href="{% url 'venue:payment' %}" class="btn btn-primary">
                                        <div class="d-flex align-items-center">
                                            <div class="mr-2">
                                                <i class="bi bi-journal-bookmark"></i>
                                            </div>
                                            <div>Book Now</div>
                                        </div>
                                    </a>
                                </div>
                            </ul>
                        </div>
                    </div>
                </div>
            {% endif %}
        {% endfor %}
        {% else %}
        {% for venue in list_venue %}
        <div class="col-md-4 mb-3">
            <div class="card" onclick="toggleDescription(this)" style="cursor:pointer;">
                <img src="/media/{{ venue.image }}" class="card-img-top rounded-top" alt="{{ venue.name }} Image"
                    width="400" height="400">
                <div class="card-body">
                    <h5 class="card-title">{{ venue.venuename }}</h5>
                    <ul class="list-unstyled">
                        <li><strong>Address:</strong> {{ venue.address }}</li>
                        <li><strong>Price:</strong> {{ venue.price }} (per plates)</li>
                        <li><strong>Capacity:</strong> {{ venue.capacity }} people</li>
                        <li><strong>Phone:</strong> {{ venue.phone }}</li>
                        <div class="description"
                            style="max-height: 0; overflow: hidden; transition: max-height 0.3s ease-out;">
                            <li><strong>Description:</strong>
                                {{ venue.description }}
                            </li>
                            <br>
                            <a href="{% url 'venue:payment' %}" class="btn btn-primary">
                                <div class="d-flex align-items-center">
                                    <div class="mr-2">
                                        <i class="bi bi-journal-bookmark"></i>
                                    </div>
                                    <div>Book Now</div>
                                </div>
                            </a>
                        </div>
                    </ul>
                </div>
            </div>
        </div>
        {% endfor %}
        {% endif %}
    </div>
</div>

<script>
    function toggleDescription(card) {
        const descriptionDiv = card.querySelector('.description');
        const maxHeight = descriptionDiv.scrollHeight;
        descriptionDiv.style.maxHeight = descriptionDiv.style.maxHeight === '0px' ? maxHeight + 'px' : '0px';

        // Scroll towards the description 50% of the way
        const halfwayPoint = window.innerHeight / 2;
        descriptionDiv.scrollIntoView({ behavior: 'smooth', block: 'start', inline: 'nearest' });

        // Alternatively, you can scroll to a specific offset if you want more control
        window.scrollBy(0, halfwayPoint);
    }
</script>
{% endblock %}
